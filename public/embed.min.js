!function(e,t){"use strict";if(!t.Halogen||"function"!=typeof t.Halogen||!t.Halogen.initialized){var n=t.Halogen&&t.Halogen.config||{},o=n.embedUrl||"http://localhost:3001",i=n.siteUrl,a=n.creationId,r=n.debug||o.includes("localhost")||i.includes("localhost"),l=function(e,t){r&&void 0!==t&&console.log("Halogen: "+e,t)},s=function(e,t){r&&void 0!==t&&console.warn("Halogen: "+e,t)},c=function(e,t){console.error("Halogen: "+e,t)};l("Embed config received:",n),l("Final values - siteUrl:",i,"creationId:",a,"embedUrl:",o);var d=t.Halogen&&t.Halogen._||[];t.Halogen=function(e,t){p(e,t)},t.Halogen.initialized=!0,t.Halogen.createEmbed=g;for(var u=0;u<d.length;u++){var f=d[u];p(f[0],f[1])}"loading"===e.readyState?e.addEventListener("DOMContentLoaded",function(){p("embed")}):p("embed")}function g(t,n){n=n||{};var r=e.createElement("iframe"),l=[];for(var s in i&&l.push("site-url="+encodeURIComponent(i)),a&&l.push("creation-id="+encodeURIComponent(a)),n)n.hasOwnProperty(s)&&l.push(s+"="+encodeURIComponent(n[s]));return r.src=o+"/embed"+(l.length?"?"+l.join("&"):""),r.style.cssText="width:100%;height:400px;border:0",r.setAttribute("title","Halogen Embed"),r.setAttribute("data-halogen-iframe","true"),t.appendChild(r),r}function p(t,n){switch(l("Processing command:",t,"with data:",n),t){case"embed":i&&a?function(e,t){l("fetchSiteConfig called with siteUrl:",e),l("API URL:",o+"/api/site-config");var n=new XMLHttpRequest;n.open("POST",o+"/api/site-config",!0),n.setRequestHeader("Content-Type","application/json"),n.onreadystatechange=function(){if(l("XHR readyState:",n.readyState,"status:",n.status),4===n.readyState)if(200===n.status){l("XHR response text:",n.responseText);try{var e=JSON.parse(n.responseText);l("Parsed response:",e),t(null,e.config)}catch(e){c("JSON parse error:",e),t(e,null)}}else c("XHR failed with status:",n.status),t(new Error("Config request failed with status: "+n.status),null)},l("Sending XHR request..."),n.send(JSON.stringify({siteUrl:e}))}(i,function(t,r){t?(s("Failed to fetch site config, using fallback embed",t),h(n)):(function(t,n,i){if(l("injectInteractiveButton called",{config:t,creationId:n,siteUrl:i}),t.showInteractiveMode&&n){var a=e.querySelector("section#mv-creation-"+n);if(l("Looking for section#mv-creation-"+n),l("Recipe section found:",!!a),a){l("Looking for selector:",t.buttonSelector);var r=a.querySelector(t.buttonSelector);if(l("Target element found:",!!r),r){var c=r.querySelector(".halogen-interactive-btn");if(l("Existing button found:",!!c),c)l("Button already exists, skipping injection");else{l("Creating button...");var d=e.createElement("button");d.className="halogen-interactive-btn",d.textContent=t.buttonText||"Try Interactive Mode!",d.style.cssText="background:#3b82f6;color:white;border:none;padding:12px 24px;border-radius:6px;cursor:pointer;font-size:14px;font-weight:600;margin:10px 0;display:inline-block;",d.onclick=function(){var t=e.getElementById("halogen-modal");t||(t=function(t,n){var i=e.createElement("div");i.id="halogen-modal",i.style.cssText="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:999999;display:none;";var a=e.createElement("button");a.innerHTML="Ã—",a.style.cssText="position:absolute;top:20px;right:30px;background:none;border:none;color:white;font-size:40px;cursor:pointer;z-index:1000000;";var r=e.createElement("iframe");return r.src=o+"/creations/"+t+"/interactive?site_url="+encodeURIComponent(n),r.style.cssText="width:100%;height:100%;border:0;",r.setAttribute("title","Halogen Interactive Recipe"),i.appendChild(a),i.appendChild(r),a.onclick=function(){i.style.display="none"},i.onclick=function(e){e.target===i&&(i.style.display="none")},e.addEventListener("keydown",function(e){"Escape"===e.key&&"block"===i.style.display&&(i.style.display="none")}),e.body.appendChild(i),i}(n,i)),t.style.display="block"},l("Appending button to target element..."),r.insertBefore(d,r.firstChild),l("Interactive button added to recipe card")}}else s("Target element not found:",t.buttonSelector)}else s("Recipe section not found for creation ID:",n)}else l("Exiting - showInteractiveMode:",t.showInteractiveMode,"creationId:",n)}(r,a,i),h(n))}):h(n);break;case"create":n&&n.element&&g(n.element,n.options||{})}}function h(t){for(var n=e.querySelectorAll("[data-halogen]"),o=0;o<n.length;o++){var i=n[o];i.querySelector("[data-halogen-iframe]")||g(i,t||{})}}}(document,window);