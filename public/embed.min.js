!function(e,t){"use strict";if(!t.Halogen||"function"!=typeof t.Halogen||!t.Halogen.initialized){var n=t.Halogen&&t.Halogen.config||{},o=n.embedUrl||"http://localhost:3001",i=n.siteUrl,r=n.creations||[];n.creationId&&0===r.length&&(r=[{creationId:n.creationId,siteUrl:i}]);var a=n.debug||o.includes("localhost")||i&&i.includes("localhost"),l=function(e,t){a&&void 0!==t&&console.log("Halogen: "+e,t)},s=function(e,t){a&&void 0!==t&&console.warn("Halogen: "+e,t)},c=function(e,t){console.error("Halogen: "+e,t)};l("Embed config received:",n),l("Final values - siteUrl:",i,"creations:",r,"embedUrl:",o);var d=t.Halogen&&t.Halogen._||[];t.Halogen=function(e,t){v(e,t)},t.Halogen.initialized=!0,t.Halogen.createEmbed=h;for(var u=0;u<d.length;u++){var f=d[u];v(f[0],f[1])}"loading"===e.readyState?e.addEventListener("DOMContentLoaded",function(){v("embed")}):v("embed")}function g(e,t){l("fetchSiteConfig called with siteUrl:",e),l("API URL:",o+"/api/site-config");var n=new XMLHttpRequest;n.open("POST",o+"/api/site-config",!0),n.setRequestHeader("Content-Type","application/json"),n.onreadystatechange=function(){if(l("XHR readyState:",n.readyState,"status:",n.status),4===n.readyState)if(200===n.status){l("XHR response text:",n.responseText);try{var e=JSON.parse(n.responseText);l("Parsed response:",e),t(null,e.config)}catch(e){c("JSON parse error:",e),t(e,null)}}else c("XHR failed with status:",n.status),t(new Error("Config request failed with status: "+n.status),null)},l("Sending XHR request..."),n.send(JSON.stringify({siteUrl:e}))}function p(t,n,i){if(l("injectInteractiveButton called",{config:t,creationId:n,siteUrl:i}),t.showInteractiveMode&&n){var r=e.querySelector("section#mv-creation-"+n);if(l("Looking for section#mv-creation-"+n),l("Recipe section found:",!!r),r){l("Looking for selector:",t.buttonSelector);var a=r.querySelector(t.buttonSelector);if(l("Target element found:",!!a),a){var c=a.querySelector(".halogen-interactive-btn");if(l("Existing button found:",!!c),c)l("Button already exists, skipping injection");else{l("Creating button...");var d=e.createElement("button");d.className="halogen-interactive-btn",d.textContent=t.buttonText||"Try Interactive Mode!",d.style.cssText="background:#3b82f6;color:white;border:none;padding:12px 24px;border-radius:6px;cursor:pointer;font-size:14px;font-weight:600;margin:10px 0;display:inline-block;",d.onclick=function(){var t="halogen-modal-"+n,r=e.getElementById(t);r||(r=function(t,n){var i=e.createElement("div");i.id="halogen-modal-"+t,i.style.cssText="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:999999;display:none;";var r=e.createElement("button");r.innerHTML="Ã—",r.style.cssText="position:absolute;top:20px;right:30px;background:none;border:none;color:white;font-size:40px;cursor:pointer;z-index:1000000;";var a=e.createElement("iframe");return a.src=o+"/creations/"+t+"/interactive?site_url="+encodeURIComponent(n),a.style.cssText="width:100%;height:100%;border:0;",a.setAttribute("title","Halogen Interactive Recipe"),i.appendChild(r),i.appendChild(a),r.onclick=function(){i.style.display="none"},i.onclick=function(e){e.target===i&&(i.style.display="none")},e.addEventListener("keydown",function(e){"Escape"===e.key&&"block"===i.style.display&&(i.style.display="none")}),e.body.appendChild(i),i}(n,i)),r.style.display="block"},l("Appending button to target element..."),a.appendChild(d),l("Interactive button added to recipe card")}}else s("Target element not found:",t.buttonSelector)}else s("Recipe section not found for creation ID:",n)}else l("Exiting - showInteractiveMode:",t.showInteractiveMode,"creationId:",n)}function h(t,n){n=n||{};var a=e.createElement("iframe"),l=[];for(var s in i&&l.push("site-url="+encodeURIComponent(i)),r.length>0&&r[0].creationId&&l.push("creation-id="+encodeURIComponent(r[0].creationId)),n)n.hasOwnProperty(s)&&l.push(s+"="+encodeURIComponent(n[s]));return a.src=o+"/embed"+(l.length?"?"+l.join("&"):""),a.style.cssText="width:100%;height:400px;border:0",a.setAttribute("title","Halogen Embed"),a.setAttribute("data-halogen-iframe","true"),t.appendChild(a),a}function v(e,t){switch(l("Processing command:",e,"with data:",t),e){case"embed":if(r.length>0){for(var n={},o=0;o<r.length;o++)(function(e){var t=e.siteUrl||i;t?n[t]||(n[t]=!0,g(t,function(e,n){if(e)s("Failed to fetch site config for",t,e);else for(var o=0;o<r.length;o++){var a=r[o];(a.siteUrl||i)===t&&p(n,a.creationId,t)}})):s("No siteUrl for creation:",e.creationId)})(r[o]);b(t)}else b(t);break;case"create":t&&t.element&&h(t.element,t.options||{})}}function b(t){for(var n=e.querySelectorAll("[data-halogen]"),o=0;o<n.length;o++){var i=n[o];i.querySelector("[data-halogen-iframe]")||h(i,t||{})}}}(document,window);